<div id="display_copy_resep">
  <div class="table-responsive no-margin">
    <table class="table table-striped no-padding">
      <thead>
        <tr>
          <th>Nama Obat</th>
          <th>Jumlah</th>
          <th>Stok</th>
          <th>Aturan Pakai</th>
        </tr>
      </thead>
      <tbody>
        {if: $copy_resep || $copy_resep_racikan}
        <form id="form_copy_resep">
        {if: $copy_resep}
        <tr>
          <td colspan="4"><strong>Obat Non-Racikan</strong></td>
        </tr>
        {loop: $copy_resep}
        <tr>
            <td{if: $value.jml > $value.stok} class="selisih"{/if}><input type="hidden" name="kode_brng_copyresep" value="{?=isset_or($value.kode_brng)?}">{?=isset_or($value.nama_brng)?}</td>
            <td><input type="text" name="jml_copyresep" value="{?=isset_or($value.jml)?}" size="5"></td>
            <td>{?=isset_or($value.stok)?}</td>
            <td><input type="text" name="aturan_copyresep" value="{?=isset_or($value.aturan_pakai)?}"></td>
        </tr>
        {/loop}
        {/if}

        {if: $copy_resep_racikan}
        <tr>
          <td colspan="4"><strong>Obat Racikan</strong></td>
        </tr>
        {loop: $copy_resep_racikan}
        <tr>
            <td colspan="4">
              <strong>{?=isset_or($value.nama_racik)?}</strong>
              <input type="hidden" name="nama_racik_copyresep" value="{?=isset_or($value.nama_racik)?}">
              <input type="hidden" name="kd_racik_copyresep" value="{?=isset_or($value.kd_racik)?}">
              <input type="hidden" name="keterangan_copyresep" value="{?=isset_or($value.keterangan)?}">
              <input type="hidden" name="no_racik_copyresep" value="{?=isset_or($value.no_racik)?}">
            </td>
        </tr>
        <tr>
            <td>Jumlah Racikan: <input type="text" name="jml_dr_copyresep" value="{?=isset_or($value.jml_dr)?}" size="5"></td>
            <td colspan="3">Aturan Pakai: <input type="text" name="aturan_pakai_copyresep" value="{?=isset_or($value.aturan_pakai)?}"></td>
        </tr>
        {loop: $value.detail as $detail}
        <tr>
            <td{if: $detail.jml > $detail.stok} class="selisih"{/if} style="padding-left: 20px;">
              <input type="hidden" name="kode_brng_racikan_copyresep_{?=isset_or($value.no_racik)?}" value="{?=isset_or($detail.kode_brng)?}">
              - {?=isset_or($detail.nama_brng)?}
            </td>
            <td><input type="text" name="jml_racikan_copyresep_{?=isset_or($value.no_racik)?}" value="{?=isset_or($detail.jml)?}" size="5"></td>
            <td>{?=isset_or($detail.stok)?}</td>
            <td><input type="hidden" name="p1_copyresep_{?=isset_or($value.no_racik)?}" value="{?=isset_or($detail.p1)?}"><input type="hidden" name="p2_copyresep_{?=isset_or($value.no_racik)?}" value="{?=isset_or($detail.p2)?}"></td>
        </tr>
        {/loop}
        {/loop}
        {/if}
        </form>
        <tr>
          <td colspan="43" class="text-center" id="simpan_copy_resep"><button type="submit" class="btn btn-primary">Simpan Copy Resep</button></td>
        </tr>
        {else}
        <tr>
          <td colspan="4" class="text-center">Tidak ada data obat.</td>
        </tr>
        {/if}
      </tbody>
    </table>
  </div>
</div>
<script>
  $("td.selisih").each(function() {
    bootbox.alert("Stok "+ $(this).text() +" tidak mencukupi!");
  });
</script>
